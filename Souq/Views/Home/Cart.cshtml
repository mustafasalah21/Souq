@model List<Cart>

@{
    var total = Model.Sum(x => x.Product.Price * x.Quantity);
}

<div class="container d-flex justify-content-center align-items-center" style="min-height: 90vh;">
    <div class="card shadow-lg p-5" style="width: 100%; max-width: 1300px;">

        <h1 class="text-center mb-5 fw-bold">🛒 Your Cart</h1>

        <div class="table-responsive">
            <table class="table table-hover text-center align-middle" style="font-size: 1.2rem;">
                <thead class="table-dark">
                    <tr>
                        <th style="padding:20px;">Product Name</th>
                        <th style="padding:20px;">Quantity</th>
                        <th style="padding:20px;">Price</th>
                        <th style="padding:20px;">Total Price</th>
                        <th style="padding:20px;">Product Image</th>
                        <th style="padding:20px;">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td class="fw-bold" style="font-size:1.3rem;">
                                @item.Product.Name
                            </td>

                            <td style="font-size:1.2rem;">
                                @item.Quantity
                            </td>

                            <td style="font-size:1.2rem;">
                                @item.Product.Price
                            </td>

                            <td class="text-success fw-bold" style="font-size:1.3rem;">
                                @(item.Product.Price* item.Quantity)
                            </td>

                            <td>
                                <a href="/Home/CuranntProduct/@item.ProductId">
                                    <img src="@item.Product.Photo"
                                         alt="@item.Product.Name"
                                         class="img-thumbnail"
                                         style="width:120px;height:120px;object-fit:cover;">
                                </a>
                            </td>

                            <td>
                                <div class="d-flex justify-content-center gap-2 flex-wrap">
                                    <a class="btn btn-success btn-lg px-3"
                                       href="/Home/IncreaseCart/@item.ProductId"
                                       title="Increase">
                                        <i class="bi bi-plus-lg"></i>
                                    </a>

                                    <a class="btn btn-warning btn-lg px-3"
                                       href="/Home/DecreaseCart/@item.ProductId"
                                       title="Decrease">
                                        <i class="bi bi-dash-lg"></i>
                                    </a>

                                    <a class="btn btn-danger btn-lg px-3"
                                       href="/Home/RemoveFromCart/@item.ProductId"
                                       title="Remove">
                                        <i class="bi bi-trash"></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <!-- ✅ TOTAL SECTION -->
        <div class="d-flex justify-content-between align-items-center mt-5 p-4 rounded" style="background:#f8f9fa;">
            <h2 class="fw-bold mb-0">Total:</h2>
            <h2 class="fw-bold text-success mb-0">@total</h2>
        </div>

    </div>
</div>


@* ✅ رسالة نجاح *@
@if (TempData["OrderSuccess"] != null)
{
    <div class="container mt-4">
        <div class="alert alert-success text-center fw-bold">
            @TempData["OrderSuccess"]
        </div>
    </div>
}

@if (Model != null && Model.Any())
{
    <div class="container mt-5 mb-5">
        <div class="card shadow-lg border-0 rounded-4" style="border:2px solid #5e41b1;">
            <div class="card-body p-4 p-md-5">

                <h3 class="text-center fw-bold mb-4" style="color:#5e41b1;">
                    🚚 Complete Your Order
                </h3>

                <form asp-controller="Home" asp-action="CompleteOrder" method="post" class="row g-4">
                    @Html.AntiForgeryToken()

                    <div class="col-12 col-md-6">
                        <label class="form-label fw-bold">Name</label>
                        <input name="name" class="form-control form-control-lg" placeholder="Your name" required />
                    </div>

                    <div class="col-12 col-md-6">
                        <label class="form-label fw-bold">Mobile</label>
                        <input name="mobile" class="form-control form-control-lg" placeholder="05xxxxxxxx" required />
                    </div>

                    <div class="col-12 col-md-6">
                        <label class="form-label fw-bold">Email</label>
                        <input name="email" type="email" class="form-control form-control-lg" placeholder="name@example.com" />
                    </div>

                    <div class="col-12 col-md-6">
                        <label class="form-label fw-bold">Address</label>
                        <input name="address" class="form-control form-control-lg" placeholder="City, Street..." required />
                    </div>

                    <div class="col-12 d-flex justify-content-center mt-3">
                        <button type="submit"
                                class="btn btn-lg text-white px-5 py-3"
                                style="background-color:#5e41b1; border-radius:14px; font-size:1.3rem; min-width:280px;">
                            Confirm Order <i class="bi bi-check2-circle ms-2"></i>
                        </button>
                    </div>
                </form>

            </div>
        </div>
    </div>
}
else
{
    <div class="container mt-4">
        <div class="alert alert-info text-center fw-bold">
            🛒 Cart is empty.
        </div>
    </div>
}
